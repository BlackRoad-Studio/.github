# Railway Deploy via Pi Self-Hosted Runner â€” Cost: $0
name: ðŸš‚ Railway Pi Deploy

on:
  push:
    branches: [master, agent/gematria]
    paths: ['blackroad-core/**', 'api/**']
  workflow_dispatch:
    inputs:
      service:
        description: 'Railway service to deploy'
        required: false
        default: 'blackroad-core'

jobs:
  deploy-railway:
    name: ðŸš€ Deploy to Railway
    runs-on: [self-hosted, pi, blackroad, gematria]
    steps:
      - uses: actions/checkout@v4

      - name: ðŸ”‘ Install Railway CLI
        run: |
          which railway || (curl -fsSL https://railway.app/install.sh | sh)
          railway --version

      - name: ðŸš€ Deploy
        env:
          RAILWAY_TOKEN: ${{ secrets.RAILWAY_TOKEN }}
        run: |
          SERVICE="${{ github.event.inputs.service || 'blackroad-core' }}"
          echo "Deploying $SERVICE to Railway..."
          cd $SERVICE 2>/dev/null && railway up --detach || railway up --detach
          echo "âœ… Deployed $SERVICE"
